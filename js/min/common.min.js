function updateUserNav(){try{const userNav=document.getElementById("userNav");if(!userNav)return;const currentUser=JSON.parse(localStorage.getItem("currentUser")||"null");if(currentUser){userNav.innerHTML=`
                <span style="color:white; margin-right:20px;">欢迎, ${currentUser.username}</span>
                <div class="nav-item" onclick="logout()">登出</div>
            `}else{userNav.innerHTML=`
                <div class="nav-item" onclick="window.location.href='login_register.html'">登录/注册</div>
            `}}catch(error){console.error("Error in updateUserNav:",error)}}function logout(){localStorage.removeItem("currentUser");localStorage.removeItem("isAuthenticated");localStorage.removeItem("authToken");updateUserNav();window.location.href="index.html"}window.addEventListener("DOMContentLoaded",updateUserNav);function scrollToDes(companyId){const section=document.getElementById(companyId);if(section){section.scrollIntoView({behavior:"smooth"})}}function ajax(options){const{url,method="GET",data=null,headers={},success=()=>{},error=()=>{}}=options;const xhr=new XMLHttpRequest;xhr.open(method,url,true);xhr.setRequestHeader("Content-Type","application/json");Object.keys(headers).forEach(key=>{xhr.setRequestHeader(key,headers[key])});xhr.onload=function(){if(xhr.status>=200&&xhr.status<300){let responseData;try{responseData=JSON.parse(xhr.responseText)}catch(e){responseData=xhr.responseText}success(responseData,xhr)}else{error(new Error(`请求失败: ${xhr.status} ${xhr.statusText}`),xhr)}};xhr.onerror=function(){error(new Error("网络错误"),xhr)};xhr.ontimeout=function(){error(new Error("请求超时"),xhr)};if(data){xhr.send(JSON.stringify(data))}else{xhr.send()}return xhr}function get(url,success,error,headers={}){return ajax({url:url,method:"GET",headers:headers,success:success,error:error})}function post(url,data,success,error,headers={}){return ajax({url:url,method:"POST",data:data,headers:headers,success:success,error:error})}